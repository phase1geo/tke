<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>TKE: /Users/trevorw/projects/tke-code/lib/themer.tcl Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="tke_logo_128.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">TKE
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">Advanced editor written in Tcl/Tk</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('themer_8tcl_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">themer.tcl</div>  </div>
</div><!--header-->
<div class="contents">
<a href="themer_8tcl.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">#!wish8.5
</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span><span class="comment"># Name:    themer.tcl
</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span><span class="comment"># Author:  Trevor Williams  (phase1geo@gmail.com)
</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span><span class="comment"># Date:    10/04/2013
</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span><span class="comment"># Brief:   Converts a *.tmTheme file to a *.tketheme file.
</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span><span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keyword">if</span> {[<span class="keyword">file</span> tail $argv0] eq &quot;themer.tcl&quot;} {

  </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;
  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <span class="keyword">set</span> tke_dir [<span class="keyword">file</span> dirname [<span class="keyword">file</span> dirname [<span class="keyword">file</span> normalize $argv0]]]<span class="comment">
</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="keyword">package</span> require msgcat<span class="comment">
</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  source [<span class="keyword">file</span> join $tke_dir lib utils.tcl]<span class="comment">
</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}<span class="comment">
</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace</span> <span class="keyword">eval</span> themer {

  </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;
  </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keyword">variable</span> theme_dir      [file join $::tke_dir data themes]<span class="comment">
</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span>  <span class="keyword">variable</span> tmtheme        &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span>  <span class="keyword">variable</span> write_callback &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keyword">array</span> set widgets     {}<span class="comment">
</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"></span>  <span class="keyword">array</span> set all_scopes  {}<span class="comment">
</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span>  <span class="keyword">array</span> set orig_labels {}<span class="comment">
</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span>  <span class="keyword">array</span> set show_vars   {}<span class="comment">
</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"></span>  <span class="keyword">array</span> set labels      {}<span class="comment">
</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keyword">array</span> set label_index {
    color      0
    tagpos     1
    scope      2
    show       3
    changed    4
  }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    color      0
    tagpos     1
    scope      2
    show       3
    changed    4
  }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    tagpos     1
    scope      2
    show       3
    changed    4
  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    scope      2
    show       3
    changed    4
  }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    show       3
    changed    4
  }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    changed    4
  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keyword">array</span> set scope_map {
    comment              comments
    keyword              keywords
    string               strings
    entity               punctuation
    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    comment              comments
    keyword              keywords
    string               strings
    entity               punctuation
    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    keyword              keywords
    string               strings
    entity               punctuation
    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    string               strings
    entity               punctuation
    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    entity               punctuation
    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    entity.name.tag      punctuation
    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    punctuation          punctuation
    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    meta.preprocessor.c  precompile
    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    other.preprocessor.c precompile
    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    constant             numbers
    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    constant.numeric     numbers
    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    meta.tag             miscellaneous1
    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    support              miscellaneous1
    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    support.function     miscellaneous1
    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    support.type         miscellaneous1
    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    variable             miscellaneous2
    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    variable.other       miscellaneous2
    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    variable.parameter   miscellaneous2
    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    storage              miscellaneous3
    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    constant.other       miscellaneous3
  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keyword">array</span> set base_labels {
    background        {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    foreground        {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    line_number       {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    warning_width     {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    background        {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    foreground        {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    line_number       {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    warning_width     {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    foreground        {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    line_number       {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    warning_width     {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    line_number       {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    warning_width     {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    warning_width     {&quot;&quot;       &quot;&quot;            &quot;&quot; 1 0}
    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    difference_sub    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    difference_add    {&quot;&quot;       &quot;&quot;            &quot;&quot; 0 0}
    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    select_background {&quot;blue&quot;   &quot;&quot;            &quot;&quot; 0 0}
    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    select_foreground {&quot;white&quot;  &quot;&quot;            &quot;&quot; 0 0}
    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    border_highlight  {&quot;yellow&quot; &quot;&quot;            &quot;&quot; 1 0}
    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    cursor            {&quot;&quot;       &quot;-background&quot; &quot;&quot; 1 0}
    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    keywords          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    comments          {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    strings           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    numbers           {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    punctuation       {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    precompile        {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    miscellaneous1    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    miscellaneous2    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    miscellaneous3    {&quot;&quot;       &quot;-foreground&quot; &quot;&quot; 1 0}
  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment"># Add trace to the labels array
</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"></span><span class="comment">  </span>trace variable themer::labels    w themer::handle_label_change<span class="comment">
</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span>  trace variable themer::show_vars w themer::handle_show_vars_change<span class="comment">
</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">#############################################################
</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Called whenever a menu item is selected in the scope menu.
</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> handle_label_change {name1 lbl op} {

    </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;
    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment"># Don&#39;t continue if the UI isn&#39;t built yet
</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {![<span class="keyword">info</span> exists widgets(txt)]} {
      </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keyword">return</span><span class="comment">
</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment"># Get the color from the label
</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels($lbl) $label_index(color)]<span class="comment">
</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment"># Set the button and label
</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(b:$lbl) configure -text [<span class="keyword">lindex</span> $labels($lbl) $label_index(scope)]<span class="comment">
</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment"># Set the image
</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {$lbl eq &quot;background&quot;} {
      </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keyword">foreach</span> {l info} [<span class="keyword">array</span> get labels] {
        </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">if</span> {[<span class="keyword">set</span> lcolor [<span class="keyword">lindex</span> $info $label_index(color)]] ne &quot;&quot;} {
          </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <a class="code" href="namespacethemer.html#a8c5ccd516d1ac0c000f377712c52725c" title="themer::set_button_image">set_button_image</a> $l $lcolor<span class="comment">
</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span>        }<span class="comment">
</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"></span>      <span class="keyword">foreach</span> tlbl [list warning_width line_number] {
        </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keyword">if</span> {[<span class="keyword">lindex</span> $labels($tlbl) $label_index(changed)] == 0} {
          </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <span class="keyword">lset</span> labels($tlbl) $label_index(color) [<a class="code" href="namespaceutils.html#adfc92fa14a2507314f09aef8c3524586" title="utils::auto_adjust_color">utils::auto_adjust_color</a> $color 40]<span class="comment">
</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"></span>        }<span class="comment">
</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span>      <span class="keyword">if</span> {[<span class="keyword">lindex</span> $labels(difference_sub) $label_index(changed)] == 0} {
        </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keyword">lset</span> labels(difference_sub) $label_index(color) [<a class="code" href="namespaceutils.html#a8c3b435ab26715ea69ffd020a52be918" title="utils::auto_mix_colors">utils::auto_mix_colors</a> $color r 30]<span class="comment">
</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span>      <span class="keyword">if</span> {[<span class="keyword">lindex</span> $labels(difference_add) $label_index(changed)] == 0} {
        </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">lset</span> labels(difference_add) $label_index(color) [<a class="code" href="namespaceutils.html#a8c3b435ab26715ea69ffd020a52be918" title="utils::auto_mix_colors">utils::auto_mix_colors</a> $color g 30]<span class="comment">
</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span>    } <span class="keyword">else</span> {
      </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <a class="code" href="namespacethemer.html#a8c5ccd516d1ac0c000f377712c52725c" title="themer::set_button_image">set_button_image</a> $lbl $color<span class="comment">
</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment"># Highlight the sample textbox
</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a671fe00d687379ff14a3f9b07adc9eaf" title="themer::highlight">highlight</a><span class="comment">
</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Handles any changes to the show_vars variable.
</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> handle_show_vars_change {name1 lbl op} {

    </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;
    </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment"># Highlight the sample textbox
</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a671fe00d687379ff14a3f9b07adc9eaf" title="themer::highlight">highlight</a><span class="comment">
</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Generates a valid RGB color.
</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> normalize_color {color} {

    </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;
    </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">if</span> {[<span class="keyword">string</span> index $color 0] eq &quot;#&quot;} {
      </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keyword">return</span> [<span class="keyword">string</span> range $color 0 6]<span class="comment">
</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span>    } <span class="keyword">else</span> {
      </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keyword">return</span> $color<span class="comment">
</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Sets the image for the type button.
</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> set_button_image {lbl color} {

    </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;
    </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment"># Delete the current image
</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> img [$widgets(b:$lbl) cget -image]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="keyword">image</span> delete $img<span class="comment">
</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment"># Create the image
</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> img [<span class="keyword">image</span> create bitmap -file [<span class="keyword">file</span> join $::tke_dir lib images color.bmp] \
                                 </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                 -background [<span class="keyword">lindex</span> $labels(background) $label_index(color)] -foreground $color]<span class="comment">
</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment"># Set the image
</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(b:$lbl) configure -image $img<span class="comment">
</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Reads the given TextMate theme file and extracts the relevant information
</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># for tke&#39;s needs.
</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> read_tmtheme {theme} {

    </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;
    </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> scope_map<span class="comment">
</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> orig_labels<span class="comment">
</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">set</span> tmtheme $theme<span class="comment">
</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">if</span> {![<span class="keyword">catch</span> { open $theme r} rc]} {

      </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;
      </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment"># Read the contents of the file into &#39;content&#39; and close the file
</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">set</span> content [<span class="keyword">string</span> map {\n { }} [read $rc]]<span class="comment">
</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span>      <span class="keyword">close</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keyword">array</span> set depth {
        plist  0
        array  0
        dict   0
        key    0
        string 0
      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        plist  0
        array  0
        dict   0
        key    0
        string 0
      }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        array  0
        dict   0
        key    0
        string 0
      }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        dict   0
        key    0
        string 0
      }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        key    0
        string 0
      }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        string 0
      }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }<span class="comment">
</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keyword">set</span> scope       0<span class="comment">
</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span>      <span class="keyword">set</span> foreground  0<span class="comment">
</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"></span>      <span class="keyword">set</span> background  0<span class="comment">
</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span>      <span class="keyword">set</span> caret       0<span class="comment">
</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"></span>      <span class="keyword">set</span> scope_types &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keyword">while</span> {[regexp {\s*([^&lt;]*)\s*&lt;(/?\w+)[^&gt;]*&gt;(.*)$} $content -&gt; value element content]} {
        </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keyword">if</span> {[<span class="keyword">string</span> index $element 0] eq &quot;/&quot;} {
          </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keyword">set</span> element [<span class="keyword">string</span> range $element 1 end]<span class="comment">
</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span>          <span class="keyword">switch</span>  $element {
            </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            key {
              </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;              <span class="keyword">switch</span>  $value {
                </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                scope      { <span class="keyword">set</span> scope      1}
                </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                foreground { <span class="keyword">set</span> foreground 1}
                </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                background { <span class="keyword">set</span> background 1}
                </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                caret      { <span class="keyword">set</span> caret      1}
              </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;              }<span class="comment">
</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"></span>            }
            </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            string {
              </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;              <span class="keyword">if</span> {$scope} {
                </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keyword">set</span> scope       0<span class="comment">
</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span>                <span class="keyword">set</span> scope_types $value<span class="comment">
</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span>              } <span class="keyword">elseif</span> {$foreground} {
                </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="keyword">set</span> foreground 0<span class="comment">
</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span>                <span class="keyword">set</span> color      [<a class="code" href="namespacethemer.html#afef15494fde6e4a72d07f16ba07bc3bb" title="themer::normalize_color">normalize_color</a> $value]<span class="comment">
</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span>                <span class="keyword">if</span> {$scope_types eq &quot;&quot;} {
                  </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                  <span class="keyword">lset</span> labels(foreground) $label_index(color) $color<span class="comment">
</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"></span>                  <span class="keyword">lset</span> labels(foreground) $label_index(scope) &quot;foreground&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span>                  <span class="keyword">set</span> all_scopes(foreground) $color<span class="comment">
</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment"></span>                } <span class="keyword">else</span> {
                  </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                  <span class="keyword">foreach</span> scope_type [<span class="keyword">string</span> map {, { }} $scope_types] {
                    </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="keyword">if</span> {[<span class="keyword">info</span> exists scope_map($scope_type)]} {
                      </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                      <span class="keyword">set</span> lbl $scope_map($scope_type)<span class="comment">
</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span>                      <span class="keyword">lset</span> labels($lbl) $label_index(color) $color<span class="comment">
</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span>                      <span class="keyword">lset</span> labels($lbl) $label_index(scope) $scope_type<span class="comment">
</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span>                    }<span class="comment">
</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span>                    <span class="keyword">set</span> all_scopes($scope_type) $color<span class="comment">
</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"></span>                  }<span class="comment">
</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span>                }<span class="comment">
</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span>              } <span class="keyword">elseif</span> {$background} {
                </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keyword">set</span> background 0<span class="comment">
</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span>                <span class="keyword">set</span> color      [<a class="code" href="namespacethemer.html#afef15494fde6e4a72d07f16ba07bc3bb" title="themer::normalize_color">normalize_color</a> $value]<span class="comment">
</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"></span>                <span class="keyword">if</span> {$scope_types eq &quot;&quot;} {
                  </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                  <span class="keyword">lset</span> labels(background)    $label_index(color) $color<span class="comment">
</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span>                  <span class="keyword">lset</span> labels(background)    $label_index(scope) &quot;background&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span>                  <span class="keyword">lset</span> labels(warning_width) $label_index(color) [<a class="code" href="namespaceutils.html#adfc92fa14a2507314f09aef8c3524586" title="utils::auto_adjust_color">utils::auto_adjust_color</a> $color 40]<span class="comment">
</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span>                  <span class="keyword">set</span> all_scopes(background) $color<span class="comment">
</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"></span>                }<span class="comment">
</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span>              } <span class="keyword">elseif</span> {$caret} {
                </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <span class="keyword">set</span> caret 0<span class="comment">
</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment"></span>                <span class="keyword">set</span> color [<a class="code" href="namespacethemer.html#afef15494fde6e4a72d07f16ba07bc3bb" title="themer::normalize_color">normalize_color</a> $value]<span class="comment">
</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span>                <span class="keyword">if</span> {$scope_types eq &quot;&quot;} {
                  </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                  <span class="keyword">lset</span> labels(cursor) $label_index(color) $color<span class="comment">
</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"></span>                  <span class="keyword">lset</span> labels(cursor) $label_index(scope) &quot;cursor&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span>                  <span class="keyword">set</span> all_scopes(cursor) $color<span class="comment">
</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span>                }<span class="comment">
</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span>              }<span class="comment">
</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span>            }
          </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          }<span class="comment">
</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span>          <span class="keyword">incr</span> depth($element) -1<span class="comment">
</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span>        } <span class="keyword">else</span> {
          </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <span class="keyword">incr</span> depth($element)<span class="comment">
</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span>        }<span class="comment">
</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    } <span class="keyword">elseif</span> {[<span class="keyword">file</span> tail $::argv0] eq &quot;themer.tcl&quot;} {

      </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;
      </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keyword">puts</span> [msgcat::mc &quot;ERROR:  Unable to read %s&quot; $theme]<span class="comment">
</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span>      <span class="keyword">puts</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span>      <span class="keyword">exit</span> 1<span class="comment">
</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment"># Save the labels array to orig_labels
</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">array</span> set orig_labels [<span class="keyword">array</span> get labels]<span class="comment">
</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span>    
  </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Reads the contents of the tketheme and stores the results
</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> read_tketheme {theme} {

    </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;
    </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> orig_labels<span class="comment">
</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">if</span> {![<span class="keyword">catch</span> { open $theme r} rc]} {

      </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;
      </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment"># Read the contents from the file and close
</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">array</span> set contents [read $rc]<span class="comment">
</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span>      <span class="keyword">close</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="comment"># Store the contents into the labels array
</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">foreach</span> {lbl info} [<span class="keyword">array</span> get labels] {
        </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keyword">if</span> {[<span class="keyword">info</span> exists contents($lbl)]} {
          </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="keyword">lset</span> labels($lbl) $label_index(color) $contents($lbl)<span class="comment">
</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span>        }<span class="comment">
</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment"># Save the labels array to orig_labels
</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">array</span> set orig_labels [<span class="keyword">array</span> get labels]<span class="comment">
</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    } <span class="keyword">elseif</span> {[<span class="keyword">file</span> tail $::argv0] eq &quot;themer.tcl&quot;} {

      </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;
      </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keyword">puts</span> [msgcat::mc &quot;ERROR:  Unable to read %s&quot; $theme]<span class="comment">
</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"></span>      <span class="keyword">puts</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span>      <span class="keyword">exit</span> 1<span class="comment">
</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Displays a window showing all of the current themes.
</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> get_theme {} {

    </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;
    </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment"># Initialize variables
</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> w            &quot;.thrwin&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> ::theme_name &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment"># Create the window
</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">toplevel</span>     $w<span class="comment">
</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> title     $w [msgcat::mc &quot;Select theme&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> transient $w .<span class="comment">
</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> resizable $w 0 0<span class="comment">
</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    ttk::frame     $w.tf<span class="comment">
</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span>    <span class="keyword">listbox</span>        $w.tf.lb -height 8 -selectmode &quot;single&quot; -yscrollcommand &quot;$w.tf.vb set&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span>    ttk::scrollbar $w.tf.vb -orient vertical -command &quot;$w.tf.lb yview&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">grid</span> rowconfigure    $w.tf 0 -weight 1<span class="comment">
</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> columnconfigure $w.tf 0 -weight 1<span class="comment">
</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $w.tf.lb -row 0 -column 0 -sticky news<span class="comment">
</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $w.tf.vb -row 0 -column 1 -sticky ns<span class="comment">
</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment"># Figure out the width of the buttons
</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> bwidth [msgcat::mcmax &quot;OK&quot; &quot;Cancel&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    ttk::frame  $w.bf<span class="comment">
</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span>    ttk::button $w.bf.ok -text [msgcat::mc &quot;OK&quot;] -width $bwidth -command {
      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      destroy .thrwin
    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span>    ttk::button $w.bf.cancel -text [msgcat::mc &quot;Cancel&quot;] -width $bwidth -command {
      destroy .thrwin
    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      destroy .thrwin
    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">pack</span> $w.bf.cancel -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> $w.bf.ok     -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">pack</span> $w.tf -fill x<span class="comment">
</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> $w.bf -fill x<span class="comment">
</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keyword">bind</span> $w.tf.lb &lt;Return&gt; {
      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      destroy .thrwin
    }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"></span>    <span class="keyword">bind</span> $w.tf.lb &lt;Double-Button-1&gt; {
      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      set ::theme_name [.thrwin.tf.lb get [.thrwin.tf.lb curselection]]
      destroy .thrwin
    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      destroy .thrwin
    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment"># Get the theme names
</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">foreach</span> theme [lsort [glob -tails -directory [<span class="keyword">file</span> join $::tke_dir data themes] *.tketheme]] {
      </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      $w.tf.lb insert end [<span class="keyword">file</span> rootname $theme]<span class="comment">
</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span>    $w.tf.lb selection set 0<span class="comment">
</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment"># Center the window and grab the focus
</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span><span class="comment">    </span>::tk::PlaceWindow $w widget .<span class="comment">
</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span>    ::tk::SetFocusGrab $w $w<span class="comment">
</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment"># Put the focus on the listbox
</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">focus</span> $w.tf.lb<span class="comment">
</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment"># Wait for the window to be closed
</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">tkwait</span> window $w<span class="comment">
</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment"># Release the grab/focus
</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span><span class="comment">    </span>::tk::RestoreFocusGrab $w $w<span class="comment">
</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keyword">if</span> {$::theme_name ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">return</span> [<span class="keyword">file</span> join $::tke_dir data themes ${::theme_name}.tketheme]<span class="comment">
</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span>    } <span class="keyword">else</span> {
      </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keyword">return</span> &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Displays a window that gets the name of a theme file.
</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> get_save_name {} {

    </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;
    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment"># Initialize variables
</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> w            &quot;[<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].swin&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> ::theme_name &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment"># Create the window
</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">toplevel</span>     $w<span class="comment">
</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> title     $w [msgcat::mc &quot;Enter theme name&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> transient $w [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>]<span class="comment">
</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> resizable $w 0 0<span class="comment">
</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    ttk::frame $w.tf<span class="comment">
</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"></span>    ttk::label $w.tf.l -text [msgcat::mc &quot;Name:&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span>    ttk::entry $w.tf.e -validate key -invalidcommand bell -validatecommand {
      [themer::get_path].swin.bf.ok configure \
        -state [expr {([string length %P] eq &quot;&quot;) ? &quot;disabled&quot; : &quot;normal&quot;}]
      return 1
    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      [themer::get_path].swin.bf.ok configure \
        -state [expr {([string length %P] eq &quot;&quot;) ? &quot;disabled&quot; : &quot;normal&quot;}]
      return 1
    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        -state [expr {([string length %P] eq &quot;&quot;) ? &quot;disabled&quot; : &quot;normal&quot;}]
      return 1
    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      return 1
    }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">pack</span> $w.tf.l -side left -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> $w.tf.e -side left -fill x -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">set</span> bwidth [msgcat::mcmax &quot;OK&quot; &quot;Cancel&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ttk::frame  $w.bf<span class="comment">
</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span>    ttk::button $w.bf.ok -text [msgcat::mc &quot;OK&quot;] -width $bwidth -state disabled -command {
      set top          [themer::get_path]
      set ::theme_name [$top.swin.tf.e get]
      destroy $top.swin
    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      set top          [themer::get_path]
      set ::theme_name [$top.swin.tf.e get]
      destroy $top.swin
    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      set ::theme_name [$top.swin.tf.e get]
      destroy $top.swin
    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      destroy $top.swin
    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span>    ttk::button $w.bf.cancel -text [msgcat::mc &quot;Cancel&quot;] -width $bwidth -command {
      destroy [themer::get_path].swin
    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      destroy [themer::get_path].swin
    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keyword">pack</span> $w.bf.cancel -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> $w.bf.ok     -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keyword">pack</span> $w.tf -fill x<span class="comment">
</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> $w.bf -fill x<span class="comment">
</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keyword">bind</span> $w.tf.e &lt;Return&gt; {
      set top [themer::get_path]
      if {[set ::theme_name [$top.swin.tf.e get]] ne &quot;&quot;} {
        destroy $top.swin
      }
    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      set top [themer::get_path]
      if {[set ::theme_name [$top.swin.tf.e get]] ne &quot;&quot;} {
        destroy $top.swin
      }
    }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      if {[set ::theme_name [$top.swin.tf.e get]] ne &quot;&quot;} {
        destroy $top.swin
      }
    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        destroy $top.swin
      }
    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      }
    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment"># Center the window and grab the focus
</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span><span class="comment">    </span>::tk::PlaceWindow $w widget [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>]<span class="comment">
</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"></span>    ::tk::SetFocusGrab $w $w<span class="comment">
</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment"># Focus on the entry
</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">focus</span> $w.tf.e<span class="comment">
</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment"># Wait for the window to be closed
</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">tkwait</span> window $w<span class="comment">
</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment"># Release the grab/focus
</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span><span class="comment">    </span>::tk::RestoreFocusGrab $w $w<span class="comment">
</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">if</span> {$::theme_name ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keyword">return</span> &quot;[<span class="keyword">file</span> tail [<span class="keyword">file</span> rootname $::theme_name]].tketheme&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span>    } <span class="keyword">else</span> {
      </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keyword">return</span> &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Writes the TKE theme file to the theme directory.
</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> write_tketheme {} {

    </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;
    </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keyword">variable</span> theme_dir<span class="comment">
</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> write_callback<span class="comment">
</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment"># If we don&#39;t have a theme name, get one
</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {$tmtheme eq &quot;&quot;} {
      </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keyword">if</span> {[<span class="keyword">set</span> tmtheme [<a class="code" href="namespacethemer.html#a7d9c8fcb6483f12c57c2c8b0a7bcbf31" title="themer::get_save_name">get_save_name</a>]] eq &quot;&quot;} {
        </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keyword">return</span> 0<span class="comment">
</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment"># Get the basename of the tmtheme file
</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> basename [<span class="keyword">file</span> rootname [<span class="keyword">file</span> tail $tmtheme]]<span class="comment">
</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">if</span> {![<span class="keyword">catch</span> { open [<span class="keyword">file</span> join $theme_dir $basename.tketheme] w} rc]} {

      </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;
      </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keyword">foreach</span> lbl [lsort [<span class="keyword">array</span> names labels]] {
        </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keyword">puts</span> $rc [<span class="keyword">format</span> &quot;%-17s \&quot;%s\&quot;&quot; $lbl [<span class="keyword">string</span> tolower [<span class="keyword">lindex</span> $labels($lbl) $label_index(color)]]]<span class="comment">
</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keyword">close</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="comment"># If we have a write callback routine, call it now
</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">if</span> {$write_callback ne &quot;&quot;} {
        </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        uplevel #0 $write_callback<span class="comment">
</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    } <span class="keyword">elseif</span> {[<span class="keyword">file</span> tail $::argv0] eq &quot;themer.tcl&quot;} {

      </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;
      </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keyword">puts</span> [msgcat::mc &quot;ERROR:  Unable to write %s&quot; [<span class="keyword">file</span> join $theme_dir $basename.tketheme]]<span class="comment">
</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment"></span>      <span class="keyword">puts</span> $rc<span class="comment">
</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span>      <span class="keyword">exit</span> 1<span class="comment">
</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keyword">return</span> 1<span class="comment">
</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Creates the UI for the importer, automatically populating it with
</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># the default values.
</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> create {{callback &quot;&quot;}} {

    </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;
    </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> write_callback<span class="comment">
</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> show_vars<span class="comment">
</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment"># Set the write callback proc
</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> write_callback $callback<span class="comment">
</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment"># Make it so that the window cannot be resized
</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">file</span> tail $::argv0] ne &quot;themer.tcl&quot;} {
      </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keyword">toplevel</span> [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>]<span class="comment">
</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment"></span>      <span class="keyword">wm</span> transient [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] .<span class="comment">
</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span>    <span class="keyword">wm</span> resizable [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] 0 0<span class="comment">
</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment"># Create top frame
</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span><span class="comment">    </span>ttk::frame [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf<span class="comment">
</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment"># Create top-left frame
</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"></span><span class="comment">    </span>ttk::frame [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf<span class="comment">
</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment"># Add background color
</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#af332596e7a0e03c538d208cc924d74d8" title="themer::create_color_row">create_color_row</a> background 0<span class="comment">
</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span>    <a class="code" href="namespacethemer.html#af332596e7a0e03c538d208cc924d74d8" title="themer::create_color_row">create_color_row</a> foreground 1<span class="comment">
</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment"># Add separator
</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment"></span><span class="comment">    </span>ttk::separator [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.sep<span class="comment">
</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.sep -row 2 -column 0 -sticky ew -padx 2 -pady 2 -columnspan 2<span class="comment">
</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keyword">set</span> i 3<span class="comment">
</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keyword">foreach</span> lbl [lsort [<span class="keyword">array</span> names labels]] {

      </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;
      </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="comment"># Don&#39;t do anything with the background and foreground labels since we have already handled them
</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">if</span> {[lsearch [list background foreground] $lbl] != -1} {
        </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        continue<span class="comment">
</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment"># Create the label and menubutton
</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"></span><span class="comment">      </span><a class="code" href="namespacethemer.html#af332596e7a0e03c538d208cc924d74d8" title="themer::create_color_row">create_color_row</a> $lbl $i<span class="comment">
</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keyword">incr</span> i<span class="comment">
</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment"># Create the top-right frame
</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"></span><span class="comment">    </span>ttk::labelframe [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf -text &quot;Sample Text&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(border) [<span class="keyword">frame</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f     -padx 1 -pady 1]<span class="comment">
</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(gutter) [text  [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f.gut   -relief flat -bd 0 -width 4  -height 10 -highlightthickness 0]<span class="comment">
</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(vr)     [<span class="keyword">frame</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f.vr    -relief flat -bd 0 -width 1]<span class="comment">
</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(txt)    [text  [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f.txt   -relief flat -bd 0 -width 40 -height 10 -highlightthickness 0]<span class="comment">
</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(warn)   [<span class="keyword">frame</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f.txt.w -relief flat -bd 0 -width 1]<span class="comment">
</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment"># Insert line numbers into gutter
</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">for</span> {<span class="keyword">set</span> i 167} {$i &lt; 197} {<span class="keyword">incr</span> i} {
      </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      $widgets(gutter) insert end &quot;$i\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment"># Insert sample text
</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(txt) insert end &quot;#ifdef DFN\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;  // Some sort of comment\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;  void foobar () {\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;    int a = 100;\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;    printf( \&quot;a: %d\\n\&quot;, a );\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;  }\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"></span>    $widgets(txt) insert end &quot;#endif\n&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment"># Tag the text widget
</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(txt) tag add precompile     1.0 1.10 9.0 9.6<span class="comment">
</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment"></span>    $widgets(txt) tag add comments       3.2 3.25<span class="comment">
</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment"></span>    $widgets(txt) tag add keywords       4.2 4.6 5.4 5.7 6.4 6.10<span class="comment">
</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment"></span>    $widgets(txt) tag add numbers        5.12 5.15<span class="comment">
</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment"></span>    $widgets(txt) tag add strings        6.12 6.21<span class="comment">
</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment"></span>    $widgets(txt) tag add miscellaneous1 6.4 6.10<span class="comment">
</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment"></span>    $widgets(txt) tag add punctuation    4.14 4.19 5.10 5.11 5.15 5.16 6.10 6.11 6.21 6.22 6.25 6.27 7.2 7.3<span class="comment">
</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment"></span>    $widgets(txt) tag add cursor         4.2 4.3<span class="comment">
</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"></span>    $widgets(txt) tag add subonly        1.0 10.0<span class="comment">
</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"></span>    $widgets(txt) tag add addonly        1.0 10.0<span class="comment">
</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"></span>    $widgets(txt) tag add sub            5.0 6.0<span class="comment">
</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span>    $widgets(txt) tag add add            6.0 7.0<span class="comment">
</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"></span>    $widgets(txt) tag add select         3.0 5.0<span class="comment">
</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment"># Disable the text widgets
</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(gutter) configure -state disabled<span class="comment">
</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"></span>    $widgets(txt)    configure -state disabled<span class="comment">
</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">grid</span> rowconfigure    [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f 0 -weight 1<span class="comment">
</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> columnconfigure [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f 2 -weight 1<span class="comment">
</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $widgets(gutter) -row 0 -column 0 -sticky ns<span class="comment">
</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $widgets(vr)     -row 0 -column 1 -sticky ns<span class="comment">
</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $widgets(txt)    -row 0 -column 2 -sticky news<span class="comment">
</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keyword">place</span> $widgets(warn) -x [font measure [$widgets(txt) cget -font] -displayof . [<span class="keyword">string</span> repeat &quot;m&quot; 30]] -relheight 1.0<span class="comment">
</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf.f -fill both -expand yes<span class="comment">
</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keyword">grid</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf -row 0 -column 0 -sticky news -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.rf -row 0 -column 1 -sticky news -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keyword">set</span> bwidth [msgcat::mcmax &quot;Reset&quot; &quot;Save As&quot; &quot;Import&quot; &quot;Create&quot; &quot;Save&quot; &quot;Cancel&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment"># Create the button frame
</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span><span class="comment">    </span>ttk::frame  [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf<span class="comment">
</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(reset) [ttk::button [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.reset  -text [msgcat::mc &quot;Reset&quot;] -width $bwidth -command {
      array set themer::labels [array get themer::orig_labels]
      themer::highlight
    }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      array set themer::labels [array get themer::orig_labels]
      themer::highlight
    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      themer::highlight
    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }]<span class="comment">
</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(saveas) [ttk::button [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.saveas -text [msgcat::mc &quot;Save As&quot;] -width $bwidth -command {
      set orig_tmtheme    $themer::tmtheme
      set themer::tmtheme &quot;&quot;
      if {[themer::write_tketheme]} {
        themer::destroy_win
      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      set orig_tmtheme    $themer::tmtheme
      set themer::tmtheme &quot;&quot;
      if {[themer::write_tketheme]} {
        themer::destroy_win
      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      set themer::tmtheme &quot;&quot;
      if {[themer::write_tketheme]} {
        themer::destroy_win
      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      if {[themer::write_tketheme]} {
        themer::destroy_win
      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        themer::destroy_win
      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      } else {
        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        set themer::tmtheme $orig_tmtheme
      }
    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      }
    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }]<span class="comment">
</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> widgets(action) [ttk::button [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.import -text [msgcat::mc &quot;Import&quot;] -width $bwidth -command {
      if {[themer::write_tketheme]} {
        themer::destroy_win
      }
    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      if {[themer::write_tketheme]} {
        themer::destroy_win
      }
    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        themer::destroy_win
      }
    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }
    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    }]<span class="comment">
</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span>    ttk::button [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.cancel -text [msgcat::mc &quot;Cancel&quot;] -width $bwidth -command {
      themer::destroy_win
    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      themer::destroy_win
    }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keyword">if</span> {$tmtheme ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.reset  -side left  -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.cancel -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf.import -side right -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf -fill both -expand yes<span class="comment">
</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment"></span>    <span class="keyword">pack</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].bf -fill x<span class="comment">
</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment"># If the window is coming from tke, center it in the window
</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">file</span> tail $::argv0] ne &quot;themer.tcl&quot;} {
      </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      ::tk::PlaceWindow [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] widget .<span class="comment">
</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"></span>  
  </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Called to destroy the window
</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> destroy_win {} {
    
    </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    
    </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment"># Clear the widgets namespace
</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">array</span> unset widgets<span class="comment">
</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="comment"># Destroy the window
</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">destroy</span> [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>]<span class="comment">
</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"></span>    
  </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Creates a row in the color selection sidebar.
</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> create_color_row {lbl row} {

    </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;
    </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> show_vars<span class="comment">
</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">if</span> {($lbl eq &quot;background&quot;) || ($lbl eq &quot;foreground&quot;) || ($lbl eq &quot;select_foreground&quot;)} {
      </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keyword">set</span> widgets(l:$lbl) [ttk::label [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.l$lbl -text &quot;     [<a class="code" href="namespacethemer.html#a50616140cc3711da0d06fb91304e5dbf" title="themer::convert_label">convert_label</a> $lbl]:&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"></span>    } <span class="keyword">else</span> {
      </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keyword">set</span> widgets(l:$lbl) [ttk::checkbutton [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.l$lbl -text &quot; [<a class="code" href="namespacethemer.html#a50616140cc3711da0d06fb91304e5dbf" title="themer::convert_label">convert_label</a> $lbl]:&quot; -variable themer::show_vars($lbl)]<span class="comment">
</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"></span>      <span class="keyword">set</span> show_vars($lbl) [<span class="keyword">lindex</span> $labels($lbl) $label_index(show)]<span class="comment">
</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">set</span> widgets(b:$lbl) [ttk::label [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.b$lbl -anchor w -relief raised]<span class="comment">
</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">bind</span> $widgets(b:$lbl) &lt;Button-1&gt; &quot;themer::show_menu $lbl&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment"># Create menu
</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> widgets(m:$lbl) [<span class="keyword">menu</span> [<a class="code" href="namespacethemer.html#a04eeae04d23596a8c023d45b78675358" title="themer::get_path">get_path</a>].tf.lf.b$lbl.mnu -tearoff 0]<span class="comment">
</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment"># Add custom command so that we don&#39;t get an error when parsing
</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span><span class="comment">    </span>$widgets(m:$lbl) add command -label [msgcat::mc &quot;Create custom&quot;] -command &quot;themer::create_custom_color $lbl&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"></span> 
    </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment"># Add them to the grid
</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">grid</span> $widgets(l:$lbl) -row $row -column 0 -sticky news -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"></span>    <span class="keyword">grid</span> $widgets(b:$lbl) -row $row -column 1 -sticky news -padx 2 -pady 2<span class="comment">
</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Replaces underscores with spaces and converts everything to title case.
</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> convert_label {name} {

    </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;
    </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">set</span> str &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment"></span>    <span class="keyword">foreach</span> part [<span class="keyword">split</span> $name _] {
      </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keyword">append</span> str &quot;[<span class="keyword">string</span> totitle $part] &quot;<span class="comment">
</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keyword">return</span> [<span class="keyword">string</span> trimright $str]<span class="comment">
</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Displays the menu for the given color type.
</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> show_menu {lbl} {
 
    </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; 
    </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"></span> 
    </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment"># If we are dealing with a theme, display the menu
</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {$tmtheme ne &quot;&quot;} {
 
      </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; 
      </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keyword">tk_popup</span> $widgets(m:$lbl) \
        </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        [<span class="keyword">winfo</span> rootx $widgets(b:$lbl)] \
        </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        [<span class="keyword">expr</span> [<span class="keyword">winfo</span> rooty $widgets(b:$lbl)] + [<span class="keyword">winfo</span> reqheight $widgets(b:$lbl)]]<span class="comment">
</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"></span> 
    </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment"># Otherwise, if we are creating a new, just launch the color chooser
</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"></span><span class="comment">    </span>} <span class="keyword">else</span> {
 
      </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; 
      </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <a class="code" href="namespacethemer.html#aca85a5512416a31b5b496151c6b82f47" title="themer::create_custom_color">create_custom_color</a> $lbl<span class="comment">
</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="comment"></span> 
    </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span> 
  </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span> 
  </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="comment">#############################################################
</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Called whenever a menu item is selected inthe scope menu.
</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> handle_menu_select {lbl scope} {

    </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;
    </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment"># Set the current color to the given scope
</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">lset</span> labels($lbl) $label_index(color) $all_scopes($scope)<span class="comment">
</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels($lbl) $label_index(scope) $scope<span class="comment">
</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Allows the user to create a custom color.
</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> create_custom_color {lbl} {

    </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;
    </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="comment"># Set the color to the chosen color
</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">tk_chooseColor</span> -initialcolor [<span class="keyword">lindex</span> $labels($lbl) $label_index(color)] -parent [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] -title [<a class="code" href="namespacethemer.html#a50616140cc3711da0d06fb91304e5dbf" title="themer::convert_label">convert_label</a> $lbl]]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <span class="keyword">lset</span> labels($lbl) $label_index(color)   $color<span class="comment">
</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"></span>      <span class="keyword">lset</span> labels($lbl) $label_index(changed) 1<span class="comment">
</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Perform the highlight on the text widget based on the current labels.
</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> highlight {} {

    </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;
    </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> show_vars<span class="comment">
</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment"># Skip if the widgets do not yet exist
</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {![<span class="keyword">info</span> exists widgets(txt)]} {
      </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keyword">return</span><span class="comment">
</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment"># Create a temporary frame to get its default color
</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">frame</span> .__tmp<span class="comment">
</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"></span>    <span class="keyword">set</span> bdcolor [.__tmp cget -background]<span class="comment">
</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"></span>    <span class="keyword">destroy</span> .__tmp<span class="comment">
</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="comment"># Get the background color
</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> bgcolor [<span class="keyword">lindex</span> $labels(background) $label_index(color)]<span class="comment">
</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment"># Colorize the border
</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(border_highlight) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      $widgets(border) configure -background [<span class="keyword">expr</span> {$show_vars(border_highlight) ? $color : $bdcolor}]<span class="comment">
</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment"># Colorize the gutter
</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(line_number) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      $widgets(gutter) configure -foreground [<span class="keyword">expr</span> {$show_vars(line_number) ? $color : $bgcolor}]<span class="comment">
</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment"># Colorize all of the foreground tags and the menu
</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">foreach</span> {lbl info} [<span class="keyword">array</span> get labels] {
      </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keyword">if</span> {[<span class="keyword">set</span> pos [<span class="keyword">lindex</span> $info $label_index(tagpos)]] ne &quot;&quot;} {
        </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        $widgets(txt) tag configure $lbl $pos [<span class="keyword">expr</span> {$show_vars($lbl) ? [lindex $info $label_index(color)] : &quot;&quot;}]<span class="comment">
</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment"># Colorize the text widget itself
</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(foreground) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      $widgets(txt) configure -foreground $color<span class="comment">
</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"></span>    <span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(background) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      $widgets(gutter) configure -background $color<span class="comment">
</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"></span>      $widgets(txt)    configure -background $color<span class="comment">
</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="comment"># Colorize the vr and warn frames
</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(warning_width) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      $widgets(vr)   configure -background [<span class="keyword">expr</span> {$show_vars(warning_width) ? $color : $bgcolor}]<span class="comment">
</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"></span>      $widgets(warn) configure -background [<span class="keyword">expr</span> {$show_vars(warning_width) ? $color : $bgcolor}]<span class="comment">
</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment"># Colorize the difference backgrounds
</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(difference_sub) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      $widgets(txt) tag configure sub     -background &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment"></span>      $widgets(txt) tag configure subonly -background &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment"></span>      <span class="keyword">if</span> {$show_vars(difference_sub)} {
        </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        $widgets(txt) tag configure [<span class="keyword">expr</span> {$show_vars(difference_add) ? &quot;sub&quot; : &quot;subonly&quot;}] -background $color<span class="comment">
</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment"></span>    <span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(difference_add) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      $widgets(txt) tag configure add     -background &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"></span>      $widgets(txt) tag configure addonly -background &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"></span>      <span class="keyword">if</span> {$show_vars(difference_add)} {
        </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        $widgets(txt) tag configure [<span class="keyword">expr</span> {$show_vars(difference_sub) ? &quot;add&quot; : &quot;addonly&quot;}] -background $color<span class="comment">
</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="comment"># Colorize the selection
</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {[<span class="keyword">set</span> color [<span class="keyword">lindex</span> $labels(select_background) $label_index(color)]] ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      $widgets(txt) tag configure select -background [<span class="keyword">expr</span> {$show_vars(select_background) ? $color : &quot;&quot;}] \
        </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        -foreground [<span class="keyword">expr</span> {$show_vars(select_background) ? [lindex $labels(select_foreground) $label_index(color)] : &quot;&quot;}]<span class="comment">
</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="comment"># Colorize the menubuttons and menus
</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">if</span> {$tmtheme ne &quot;&quot;} {
      </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keyword">foreach</span> {lbl info} [<span class="keyword">array</span> get labels] {
        </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keyword">set</span> mnu $widgets(m:$lbl)<span class="comment">
</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"></span>        <span class="keyword">foreach</span> scope [<span class="keyword">array</span> names all_scopes] {
          </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          <span class="keyword">catch</span> { $mnu entryconfigure $scope -foreground $all_scopes($scope)}<span class="comment">
</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"></span>        }<span class="comment">
</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Returns the name of the top-level window.
</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> get_win {} {

    </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;
    </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keyword">return</span> [<span class="keyword">expr</span> {([file tail $::argv0] eq &quot;themer.tcl&quot;) ? &quot;.&quot; : &quot;.thwin&quot;}]<span class="comment">
</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Returns the path of the top-level window.
</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> get_path {} {

    </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;
    </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keyword">return</span> [<span class="keyword">expr</span> {([file tail $::argv0] eq &quot;themer.tcl&quot;) ? &quot;&quot; : &quot;.thwin&quot;}]<span class="comment">
</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Imports the given TextMate theme and displays the result in the UI.
</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> import_tm {theme {callback &quot;&quot;}} {

    </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;
    </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keyword">variable</span> base_labels<span class="comment">
</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment"># Set the theme
</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> tmtheme $theme<span class="comment">
</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment"># Initialize the labels array
</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">array</span> set labels [<span class="keyword">array</span> get base_labels]<span class="comment">
</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="comment"># Create the UI
</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a0888da835cb2de1e28db33f45755a60b" title="themer::create">create</a> $callback<span class="comment">
</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment"># Initialize the widgets
</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">wm</span> title [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] [msgcat::mc &quot;Import TextMate Theme&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span>    $widgets(action) configure -text [msgcat::mc &quot;Import&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"></span>    <span class="keyword">catch</span> { <span class="keyword">pack</span> $widgets(reset) -side left -padx 2 -pady 2}<span class="comment">
</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment"># Set the label colors to red
</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">foreach</span> l [<span class="keyword">array</span> names widgets l:*] {
      </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      $widgets(b:[<span class="keyword">lindex</span> [<span class="keyword">split</span> $l :] 1]) configure -compound left<span class="comment">
</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"></span>    }<span class="comment">
</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="comment"># Read the theme
</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#ab9d57f87f71cad47d93f7bc811cfb56a" title="themer::read_tmtheme">read_tmtheme</a> $theme<span class="comment">
</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment"># Update the menus
</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">foreach</span> mnu [<span class="keyword">array</span> names widgets m:*] {

      </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;
      </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keyword">set</span> lbl [<span class="keyword">lindex</span> [<span class="keyword">split</span> $mnu :] 1]<span class="comment">
</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="comment"># Clear the menu
</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"></span><span class="comment">      </span>$widgets($mnu) delete 0 end<span class="comment">
</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="comment"># Add the custom menu
</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment"></span><span class="comment">      </span>$widgets($mnu) add command -label [msgcat::mc &quot;Create custom&quot;] -command &quot;themer::create_custom_color $lbl&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"></span>      $widgets($mnu) add separator<span class="comment">
</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"></span>
      </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="comment"># Add the scopes to the menu
</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment"></span><span class="comment">      </span><span class="keyword">set</span> i 2<span class="comment">
</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span>      <span class="keyword">foreach</span> scope [lsort [<span class="keyword">array</span> names all_scopes]] {
        </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        $widgets($mnu) add command -label $scope -columnbreak [<span class="keyword">expr</span> ($i % 40) == 39] \
          </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;          -command &quot;themer::handle_menu_select $lbl $scope&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment"></span>        <span class="keyword">incr</span> i<span class="comment">
</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment"></span>      }<span class="comment">
</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Imports the given tke theme and displays the result in the UI.
</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> import_tke {theme {callback &quot;&quot;}} {

    </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;
    </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">variable</span> base_labels<span class="comment">
</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> all_scopes<span class="comment">
</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment"># Set the theme
</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> tmtheme $theme<span class="comment">
</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment"># Initialize the labels array
</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">array</span> set labels [<span class="keyword">array</span> get base_labels]<span class="comment">
</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment"># Create the UI
</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a0888da835cb2de1e28db33f45755a60b" title="themer::create">create</a> $callback<span class="comment">
</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment"># Initialize UI
</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">wm</span> title [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] [msgcat::mc &quot;Edit theme&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment"></span>    $widgets(action) configure -text [msgcat::mc &quot;Save&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment"></span>    <span class="keyword">catch</span> { <span class="keyword">pack</span> $widgets(reset) -side left -padx 2 -pady 2}<span class="comment">
</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment"></span>    <span class="keyword">catch</span> { <span class="keyword">pack</span> $widgets(saveas) -side right -padx 2 -pady 2}<span class="comment">
</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment"># Read the theme
</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a8f87051ab6cd85650985850d67ac2b97" title="themer::read_tketheme">read_tketheme</a> $theme<span class="comment">
</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Allows the user to create a new theme.
</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> create_new {{callback &quot;&quot;}} {

    </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;
    </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keyword">variable</span> base_labels<span class="comment">
</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> labels<span class="comment">
</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> widgets<span class="comment">
</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> tmtheme<span class="comment">
</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment"></span>    <span class="keyword">variable</span> label_index<span class="comment">
</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment"># Clear the theme
</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">set</span> tmtheme &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="comment"># Initialize the labels array
</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">array</span> set labels [<span class="keyword">array</span> get base_labels]<span class="comment">
</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span>    
    </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment"># Create the UI
</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment"></span><span class="comment">    </span><a class="code" href="namespacethemer.html#a0888da835cb2de1e28db33f45755a60b" title="themer::create">create</a> $callback<span class="comment">
</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment"># Initialize the widgets
</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">wm</span> title [<a class="code" href="namespacethemer.html#ad38ff5828905999db9b0015f07e0a402" title="themer::get_win">get_win</a>] [msgcat::mc &quot;Create New Theme&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment"></span>    $widgets(action) configure -text [msgcat::mc &quot;Create&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment"></span>    <span class="keyword">catch</span> { <span class="keyword">pack</span> forget $widgets(reset)}<span class="comment">
</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment"># Initialize the labels array
</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"></span><span class="comment">    </span><span class="keyword">lset</span> labels(background)        $label_index(color) &quot;black&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(foreground)        $label_index(color) &quot;white&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(select_background) $label_index(color) &quot;blue&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(select_foreground) $label_index(color) &quot;white&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(border_highlight)  $label_index(color) &quot;yellow&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(cursor)            $label_index(color) &quot;grey&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(keywords)          $label_index(color) &quot;red&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(comments)          $label_index(color) &quot;blue&quot;<span class="comment">
</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(strings)           $label_index(color) &quot;green&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(numbers)           $label_index(color) &quot;orange&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(punctuation)       $label_index(color) &quot;white&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(precompile)        $label_index(color) &quot;yellow&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(miscellaneous1)    $label_index(color) &quot;pink&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(miscellaneous2)    $label_index(color) &quot;gold&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(miscellaneous3)    $label_index(color) &quot;green&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(line_number)       $label_index(color) [<a class="code" href="namespaceutils.html#adfc92fa14a2507314f09aef8c3524586" title="utils::auto_adjust_color">utils::auto_adjust_color</a> &quot;black&quot; 40]<span class="comment">
</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(warning_width)     $label_index(color) [<a class="code" href="namespaceutils.html#adfc92fa14a2507314f09aef8c3524586" title="utils::auto_adjust_color">utils::auto_adjust_color</a> &quot;black&quot; 40]<span class="comment">
</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(difference_sub)    $label_index(color) [<a class="code" href="namespaceutils.html#a8c3b435ab26715ea69ffd020a52be918" title="utils::auto_mix_colors">utils::auto_mix_colors</a> &quot;black&quot; r 30]<span class="comment">
</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment"></span>    <span class="keyword">lset</span> labels(difference_add)    $label_index(color) [<a class="code" href="namespaceutils.html#a8c3b435ab26715ea69ffd020a52be918" title="utils::auto_mix_colors">utils::auto_mix_colors</a> &quot;black&quot; g 30]<span class="comment">
</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}<span class="comment">
</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keyword">if</span> {[<span class="keyword">file</span> tail $argv0] eq &quot;themer.tcl&quot;} {

  </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;
  </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="comment">######################################################################
</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># Displays usage message if this script is being executed from the
</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="comment"># command-line.
</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">proc</span> usage {} {

    </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;
    </div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keyword">puts</span> &quot;Usage:  themer (-h | &lt;tmTheme file&gt; | &lt;tkeTheme file&gt;)&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment"></span>    <span class="keyword">puts</span> &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment"></span>    <span class="keyword">puts</span> &quot;Options:&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment"></span>    <span class="keyword">puts</span> &quot;  -h  Displays this help information&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment"></span>    <span class="keyword">puts</span> &quot;&quot;<span class="comment">
</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment"></span>
    </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keyword">exit</span><span class="comment">
</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  }<span class="comment">
</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment"># Parse the command-line options
</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"></span><span class="comment">  </span><span class="keyword">set</span> i 0<span class="comment">
</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment"></span>  <span class="keyword">while</span> {$i &lt; $argc} {
    </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keyword">switch</span>  [<span class="keyword">lindex</span> $argv $i] {
      </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      -h      { <a class="code" href="tke_8tcl.html#a5684f219761d78b4f98e7b2869dd1726" title="usage">usage</a>}
      </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      default { <span class="keyword">set</span> theme [<span class="keyword">lindex</span> $argv $i]}
    </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"></span>    <span class="keyword">incr</span> i<span class="comment">
</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"></span>  }<span class="comment">
</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment"># Set the theme to clam
</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"></span><span class="comment">  </span>ttk::style theme use clam<span class="comment">
</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"></span>
  </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keyword">if</span> {[<span class="keyword">info</span> exists theme]} {
    </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keyword">set</span> ext [<span class="keyword">string</span> tolower [<span class="keyword">file</span> extension $theme]]<span class="comment">
</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"></span>    <span class="keyword">switch</span> -exact -- $ext {
      </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      .tmtheme  { <a class="code" href="namespacethemer.html#ac26e49fec27d89e295844e4ee04973e8" title="themer::import_tm">themer::import_tm</a> $theme}
      </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      .tketheme { <a class="code" href="namespacethemer.html#a8f428707b4a7dae13a7f569a09643dbd" title="themer::import_tke">themer::import_tke</a> $theme}
      </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      default   {
        </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keyword">puts</span> [msgcat::mc &quot;Error:  Theme is not a supported theme&quot;]<span class="comment">
</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment"></span>        <a class="code" href="tke_8tcl.html#a5684f219761d78b4f98e7b2869dd1726" title="usage">usage</a><span class="comment">
</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment"></span>      }
    </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    }<span class="comment">
</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment"></span>  } <span class="keyword">else</span> {
    </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <a class="code" href="namespacethemer.html#ab5832ae70c87ff4da2d9b24ca873ff5a" title="themer::create_new">themer::create_new</a><span class="comment">
</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"></span>  }<span class="comment">
</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment"></span>
</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}<span class="comment">
</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment"></span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="themer_8tcl.html">themer.tcl</a></li>
    <li class="footer">Generated on Fri Jul 17 2015 08:34:46 for TKE by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
